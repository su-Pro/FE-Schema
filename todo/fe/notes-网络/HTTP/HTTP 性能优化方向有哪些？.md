## HTTP 性能优化方向有哪些？

HTTP 最基本的就是“请求 - 应答”模型，在这个模型里有两个角色:客户端和服务器，还有中间的传输链路，考查性能就可以看这三个部分。

### 服务端

衡量服务器性能的主要指标有三个:吞吐量(requests per second)、并发数 (concurrency)和响应时间(time per request)。

#### 吞吐量

吞吐量就是我们常说的 RPS，每秒的请求次数，也有叫 TPS、QPS，它是服务器最基本的 性能指标，RPS 越高就说明服务器的性能越好。

#### 并发数

并发数反映的是服务器的负载能力，也就是服务器能够同时支持的客户端数量，当然也是越 多越好，能够服务更多的用户。

#### 响应时间

响应时间反映的是服务器的处理能力，也就是快慢程度，响应时间越短，单位时间内服务器 就能够给越多的用户提供服务，提高吞吐量和并发数。

### 客户端

客户端是信息的消费者，一切数据都要通过网络从服务器获取，所以它最基本的性能指标就 是“延迟”(latency)。

1. 第一个因素是不可逾越”的障碍——光速.
2. 第二个因素是带宽，它又包括接入互联网时的电缆、WiFi、4G 和运营商内部网络、 运营商之间网络的各种带宽，每一处都有可能成为数据传输的瓶颈，降低传输速度，增加延 迟。
3. 第三个因素是 DNS 查询，如果域名在本地没有缓存，就必须向 DNS 系统发起查询，引发 一连串的网络通信成本，而在获取 IP 地址之前客户端只能等待，无法访问网站。
4. 第四个因素是 TCP 握手，你应该对它比较熟悉了吧，必须要经过 SYN、SYN/ACK、ACK 三个包之后才能建立连接，它带来的延迟由光速和带宽共同决定。

### 中间链路

![20200610214442]( https://supyyy-1259673491.cos.ap-beijing.myqcloud.com/2020/pictures20200610214442.png)

“第一公里”是指网站的出口，也就是服务器接入互联网的传输线路，它的带宽直接决定了 网站对外的服务能力，也就是吞吐量等指标。显然，优化性能应该在这“第一公里”加大投 入，尽量购买大带宽，接入更多的运营商网络。

“中间一公里”就是由许多小网络组成的实际的互联网，其实它远不止“一公里”，而是非 常非常庞大和复杂的网络，地理距离、网络互通都严重影响了传输速度。好在这里面有一个 HTTP 的“好帮手”——CDN，它可以帮助网站跨越“千山万水”，让这段距离看起来真 的就好像只有“一公里”。

“最后一公里”是用户访问互联网的入口，对于固网用户就是光纤、网线，对于移动用户就 是 WiFi、基站。以前它是客户端性能的主要瓶颈，延迟大带宽小，但随着近几年 4G 和高 速宽带的普及，“最后一公里”的情况已经好了很多，不再是制约性能的主要因素了。
